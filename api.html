<!DOCTYPE html>
<HTML>
<HEAD>
    <TITLE>API</TITLE>
    <LINK type="text/css" rel="stylesheet" href="css/common.css" media="screen,projection" />
	<LINK type="text/css" rel="stylesheet" href="css/welcome.css" media="screen,projection" />
    <LINK rel="SHORTCUT ICON" HREF="/favicon.png" />
    <META charset="UTF-8" />
</HEAD>

<BODY>

    <DIV id="banner">
        <SPAN id="main-logo" class="logoblue-text">API</SPAN> documentation
    </DIV>
    
    The PDF review tool offers easy, scriptable access to some of the underling functions.<BR/>
    Feel free to add these to scripts to make your lives easier.<BR/><BR/>
    
    <P>The general method is to send the underlying script a GET or POST request containing the data listed out in each section.</P>
    <P>The response will in general be a JSON object with an errorCode identifier. An errorCode of zero indicates the request completed successfully.</P>
    
    
    <BR/><BR/>
    <P><H2>Get your list of reviews</H2>
    Returns a list of all the reviews you are participating in.
    <UL>
        <LI><SPAN class="code">api = get-review-list</SPAN> An "action" parameter set to "get-review-list" selects this API function.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
        <LI><SPAN class="code">reviews</SPAN> Returns an array of objects for each review. These will contain the following properties:
            <LI><SPAN class="code">id</SPAN> The ID of the review.</LI>
            <LI><SPAN class="code">owner</SPAN> A boolean indicating whether you are an owner of this review.</LI>
            <LI><SPAN class="code">title</SPAN> The title of the review.</LI>
            <LI><SPAN class="code">closed</SPAN> A boolean indicating whether the review is closed.</LI>
            <LI><SPAN class="code">pdf</SPAN> The relative url of the review PDF file.</LI>
        </LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Create a review</H2>
    Creates a new review with the specified PDF file.
    <UL>
        <LI><SPAN class="code">action = upload</SPAN> An "action" parameter set to "upload" selects this API function.</LI>
        <LI><SPAN class="code">file</SPAN> This is a binary blob of the pdf file to review.</LI>
        <LI><SPAN class="code">filename</SPAN> The title of the review to be used if the title cannot be extracted from the PDF file directly.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">file</SPAN> parameter.</LI>
                <LI>Invalid or missing <SPAN class="code">filename</SPAN> parameter.</LI>
                <LI>Database error, the review could not be created.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
        <LI><SPAN class="code">reviewId</SPAN> Returns the reviewID.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Add a review comment</H2>
    Creates a new comment on the review PDF.
    <UL>
        <LI><SPAN class="code">api = add-comment</SPAN> An "api" parameter set to "add-comment" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">comment</SPAN> A JSON object containing the following information:
            <UL>
                <LI><SPAN class="code">id</SPAN> The unique identifier of the comment.</LI>
                <LI><SPAN class="code">pageId</SPAN> The zero-based PDF page on which the comment is placed.</LI>
                <LI><SPAN class="code">type</SPAN> Type of comment. Valid values are "highlight", "comment", and "strike". More types may be supported in the future.</LI>
                <LI><SPAN class="code">msg</SPAN> Comment message.</LI>
                <LI><SPAN class="code">replyToId</SPAN> <I class="grey-text">[optional]</I> ID of the comment that is being replied to.</LI>
                <LI><SPAN class="code">rects</SPAN> <I class="grey-text">[not required if replyToId specified]</I> An array of objects containing the top-left corner "tl": [x, y], and bottom-right "br": [x, y] co-ordinates of each selection rectangle. In the case of a type "comment", only "tl" is required.</LI>
            </UL>
        </LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">commentid</SPAN> or <SPAN class="code">review</SPAN> parameter.</LI>
                <LI>Invalid <SPAN class="code">comment</SPAN> content.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Delete review comment</H2>
    Deletes a comment from the review PDF.
    <UL>
        <LI><SPAN class="code">api = delete-comment</SPAN> An "api" parameter set to "delete-comment" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">commentid</SPAN> The ID of the comment.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">commentid</SPAN> or <SPAN class="code">review</SPAN> parameter.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Update comment status</H2>
    Can be used to set the status of a comment.
    <UL>
        <LI><SPAN class="code">api = update-comment-status</SPAN> An "api" parameter set to "update-comment-status" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">commentid</SPAN> The ID of the comment.</LI>
        <LI><SPAN class="code">status</SPAN> The new status of the comment.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">commentid</SPAN>, <SPAN class="code">review</SPAN>, or <SPAN class="code">status</SPAN> parameter.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Update comment message</H2>
    Change the text of an existing comment.
    <UL>
        <LI><SPAN class="code">api = update-comment-message</SPAN> An "api" parameter set to "update-comment-message" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">commentid</SPAN> The ID of the comment.</LI>
        <LI><SPAN class="code">message</SPAN> The new value of the comment message.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">commentid</SPAN>, <SPAN class="code">review</SPAN>, or <SPAN class="code">message</SPAN> parameter.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>List comments</H2>
    Returns all the comments associated with a review.
    <UL>
        <LI><SPAN class="code">api = update-comment-message</SPAN> An "api" parameter set to "update-comment-message" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success. This always succeeds, but the returned comments may be empty.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
        <LI><SPAN class="code">comments</SPAN> Returns the JSON list of all comments. See <A HREF="#comment-format">comment format</A>.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Update comment read/unread</H2>
    Can be used to mark a comment as 'read' or 'unread'.
    <UL>
        <LI><SPAN class="code">api = user-mark-comment</SPAN> An "api" parameter set to "user-mark-comment" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">commentid</SPAN> The ID of the comment.</LI>
        <LI><SPAN class="code">status</SPAN> "read" or "unread".</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Invalid or missing <SPAN class="code">commentid</SPAN>, <SPAN class="code">review</SPAN>, or <SPAN class="code">status</SPAN> parameter.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Close a review</H2>
    Can be used to close a review. Only the PDF review owner can do this.
    <UL>
        <LI><SPAN class="code">api = close-review</SPAN> An "api" parameter set to "close-review" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Not review owner, permission denied.</LI>
                <LI>Review could not be located.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Re-open a review</H2>
    Can be used to re-open a review. Only the PDF review owner can do this.
    <UL>
        <LI><SPAN class="code">api = reopen-review</SPAN> An "api" parameter set to "reopen-review" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Not review owner, permission denied.</LI>
                <LI>Review could not be located.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2>Delete a review</H2>
    Can be used to delete a review. Only the PDF review owner can do this.
    <UL>
        <LI><SPAN class="code">api = delete-review</SPAN> An "api" parameter set to "delete-review" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Not review owner, permission denied.</LI>
                <LI>Review could not be located.</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
    </UL>
    </P>


    <BR/><BR/>
    <P><H2>Archive a review</H2>
    Can be used to generate an archived version of the review including all or selected comments.
    <UL>
        <LI><SPAN class="code">api = pdf-archive</SPAN> An "api" parameter set to "pdf-archive" selects this API function.</LI>
        <LI><SPAN class="code">review</SPAN> The ID of the review.</LI>
        <LI><SPAN class="code">password</SPAN> <I class="grey-text">[optional]</I> A password for the PDF file.</LI>
        <LI><SPAN class="code">commentid</SPAN> <I class="grey-text">[optional]</I> A comment ID. If present, only that comment (and it's replies) and only that page will be included. If omitted, all comments and pages will be included.</LI>
        <LI><SPAN class="code">format</SPAN> <I class="grey-text">[optional]</I> Either <SPAN class="code">pdf</SPAN> or <SPAN class="code">png</SPAN>. PDF is the default. Note that annotations and comments cannot be displayed in PNG format.</LI>
    </UL>
    <B>Responses</B>
    <UL>
        <LI><SPAN class="code">errorCode</SPAN> The status of the request. Valid values are:
            <OL start=0>
                <LI>Success.</LI>
                <LI>Missing parameter: reviewID.</LI>
                <LI>Review could not be located.</LI>
                <LI>Conversion error.</LI>
                <LI>Specified commentt ID is invalid (no suitable comments found).</LI>
            </OL>
        </LI>
        <LI><SPAN class="code">errorMsg</SPAN> <I class="grey-text">[optional]</I> Will provide a text description of any error that occurs.</LI>
        <LI><SPAN class="code">url</SPAN> Will provide the URL of the file generated, can be downloaded via a seperate request.</LI>
    </UL>
    </P>
    
    
    <BR/><BR/>
    <P><H2><A NAME="comment-format">Format of the comment list</A></H2>
    This is a description of the various fields found within the comment list.<BR/>
    All comments will contain the following:
    <UL>
        <LI><SPAN class="code">id</SPAN> The ID of the comment.</LI>
        <LI><SPAN class="code">author</SPAN> The name of the user who created the comment.</LI>
        <LI><SPAN class="code">msg</SPAN> <I class="grey-text">[May be empty]</I> The comment text content. This will contain raw formatting and should be processed accordingly.</LI>
        <LI><SPAN class="code">status</SPAN> <I class="grey-text">[May be empty]</I> The comment text status. May contain raw formatting and should be processed accordingly.</LI>
        <LI><SPAN class="code">secs_UTC</SPAN> Timestamp of when the comment was created, in seconds from the epoch which on this system is January 1, 1970, 00:00:00 (UTC) with leap seconds are not counted towards the time in seconds since the epoch. This is standard "unix time".</LI>
        <LI><SPAN class="code">unread</SPAN> <I class="grey-text">[May be absent]</I> Boolean, whether the user has read the comment or not. If missing, the user has read the comment.</LI>
        <LI><SPAN class="code">owner</SPAN> Boolean, true if the current user is the original author of the comment.</LI>
    </UL>
    
    Comments that are not replies to comments will generally contain the following:
    <UL>
        <LI><SPAN class="code">pageId</SPAN> The zero-based PDF page on which the comment is located.</LI>
        <LI><SPAN class="code">type</SPAN> Comment type, either "highlight", "strike", or "comment".</LI>
        <LI><SPAN class="code">rects</SPAN> Array of rects containing the area to be selected. In the case of a "comment" type, only the "tl" rect entry will be present.</LI>
    </UL>
    
    Comments that are replies to comments must contain the following:
    <UL>
        <LI><SPAN class="code">replyToId</SPAN> The ID of the comment being replied to.</LI>
    </UL>
    </P>


    <BR/><BR/>
    <P><H2><A NAME="json-export-format">Format of the JSON export</A></H2>
    This is a description of the various fields that can be obtained via the json export (<SPAN class="code">api=export-comments, as=json</SPAN>).<BR/>
    The export will be an array of the following objects:
    <UL>
        <LI><SPAN class="code">id</SPAN> The ID of the comment.</LI>
        <LI><SPAN class="code">author</SPAN> The name of the user who created the comment.</LI>
        <LI><SPAN class="code">msg</SPAN> The comment text content. This will contain raw formatting and should be processed accordingly.</LI>
        <LI><SPAN class="code">status</SPAN> The comment text status. May contain raw formatting and should be processed accordingly.</LI>
        <LI><SPAN class="code">secs_UTC</SPAN> Timestamp of when the comment was created, in seconds from the epoch which on this system is January 1, 1970, 00:00:00 (UTC) with leap seconds are not counted towards the time in seconds since the epoch. This is standard "unix time".</LI>
        <LI><SPAN class="code">read</SPAN> Boolean, whether the user has read the comment or not.</LI>
        <LI><SPAN class="code">owner</SPAN> Boolean, true if the current user is the original author of the comment.</LI>
        <LI><SPAN class="code">pageId</SPAN> The zero-based PDF page on which the comment is located.</LI>
        <LI><SPAN class="code">type</SPAN> Comment type, either "highlight", "strike", "comment", or "reply".</LI>
        <LI><SPAN class="code">rects</SPAN> Array of rects containing the area to be selected. In the case of a "comment" type, only the "tl" rect entry will be present.</LI>
        <LI><SPAN class="code">replies</SPAN> An array of comments that reply to this one.</LI>
    </UL>
    </P>

</BODY>
</HTML>
